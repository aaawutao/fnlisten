<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">

    <title>Title</title>

    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
   <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
-->

</head>
<body>
<div data-v-8b689e88="" data-v-b39d6196="" class="account_info">
    <div data-v-0ca0411d="" data-v-8b689e88="" class="title">
        <div data-v-0ca0411d="" class="left">
            <p data-v-0ca0411d="">基本信息</p>
            <div data-v-0ca0411d="" class="tag">
            </div>
        </div>
        <div data-v-0ca0411d="" class="right">
        </div>
    </div>

    <div id="query" style="display: none">
        <form>
            <img id="cropedBigImg" src="" style="width: 100px;height: 100px" class="img-rounded">
            <div class="form-group">
                <label for="chooseImage">头像</label>
                <input type="file" id="chooseImage">
            </div>
            <div class="form-group">
                <label for="exampleInputName">昵称</label>
                <input type="text" id="exampleInputName" name="front_username"  onblur="checkusername()" class="form-control" style="width: 190px"  >
                <p id="checkusername"></p>
            </div>
            <button type="submit" class="btn btn-primary">保存</button>
            <button id="resultfrom" class="btn btn-warning">取消</button>
        </form>
    </div>


    <div data-v-8b689e88="" class="info_wrap">
       <div id="show">
           <div data-v-8b689e88="" class="info">
               <div data-v-8b689e88="" class="label">
                   昵称
               </div>
               <div data-v-8b689e88="" class="value">
                   <input type="hidden" id="front_userid" name="front_userid" th:value="${session?.user?.get('front_userid')}" />
                   <span id="front_username"></span>
                   <div id='show1' style="display:none">
                   </div>
               </div>
           </div>
           <div data-v-8b689e88="" class="info">
               <div data-v-8b689e88="" class="label">
                   头像
               </div>
               <div data-v-8b689e88="" class="value">
                   <img data-v-8b689e88="" class="cover" style="display: none;">
                   <img data-v-8b689e88="" id="front_userpic" src="" class="cover" />
               </div>
           </div>
           <div data-v-8b689e88="" class="info">
               <div data-v-8b689e88="" class="label">
                   手机号码
               </div>
               <div data-v-8b689e88="" class="value">
                   <span id="front_userphone"></span>
               </div>
           </div>
           <div data-v-8b689e88="" class="info">
               <div data-v-8b689e88="" class="label">
                   实名认证
               </div>
               <div data-v-8b689e88="" class="value">
                   <span id="front_userflag"></span>
               </div>
               <div id="fuserflag" data-v-8b689e88="" class="operation">
                   <span data-v-8b689e88="" class="can_edit">查看认证信息</span>
               </div>
           </div>
           <div data-v-8b689e88="" class="info">
               <div data-v-8b689e88="" class="label">
                   设置密码
               </div>
               <div data-v-8b689e88="" class="value">
                   <span id="front_userpwd"></span>
               </div>
               <div>
               </div>
           </div>
           <button id="btn" onclick="uploadfrom()" class="btn btn-primary">修改个人信息</button>
       </div>


    </div>
</div>
</body>

<script th:src="@{'/js/jquery.min.js?v=36'}"></script>



<script>

    //校验姓名
    function checkusername(){
        var name = $("#exampleInputName").val();
        if(name==""){
            $("#checkusername").html("请输入昵称");
            return false;
        }
        $("#checkusername").html("");
        return true;
    }
    function uploadfrom(){
        $("#show").hide();
        $("#query").show();
        var userid = $("#front_userid").val();

    }
    $(function() {
        var userid = $("#front_userid").val();
        $.ajax({
            type: "post",
            url: "frontuser/queryByuserId",
            data: {
                "front_userid": userid
            },
            success: function(data) {
                $("#front_username").html(data.front_username);
                $("#exampleInputName").val(data.front_username);
                $("#front_userphone").html(data.front_userphone);
                $("#front_userpic").attr("src", data.front_userpic);
                $("#cropedBigImg").attr("src", data.front_userpic);

                if (data.front_userflag == 2) {
                    $("#front_userflag").html("已认证");
                    $("#fuserflag").show();
                } else {
                    $("#front_userflag").html("未认证");
                    $("#fuserflag").hide();
                }
                var s = data.front_userpwd = "*********";
                $("#front_userpwd").html(s);

            }
        })
        $("#chooseImage").on('change',function () {
            //获取到input的value，里面是文件的路径
            var filePath=$(this).val();
            var fileFormat = filePath.substring(filePath.lastIndexOf(".")).toLowerCase();
            if( !fileFormat.match(/.png|.jpg|.jpeg/) ) {
                $("#checkpic").html("上传错误,文件格式必须为：png/jpg/jpeg'");
                return;
            }else{
                $("#checkpic").html("");
            }
            var src = window.URL.createObjectURL(this.files[0]); //转成可以在本地预览的格式
            $('#cropedBigImg').attr('src',src);
        })
    })

</script>
<style>
    div p {
        color: red;
        font-size: 12px;
    }
</style>
</html>