<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<body>


<div id="jp_container_N">
    <div class="jp-type-playlist">
        <div id="jplayer_N" class="jp-jplayer hide"></div>
        <div class="jp-gui">

            <div class="jp-interface">
                <div class="jp-controls">
                    <div><a class="jp-previous"><i class="icon-control-rewind i-lg"></i></a></div>
                    <div>
                        <a class="jp-play"><i class="icon-control-play i-2x"></i></a>
                        <a class="jp-pause hid"><i class="icon-control-pause i-2x"></i></a>
                    </div>
                    <div><a class="jp-next"><i class="icon-control-forward i-lg"></i></a></div>
                    <div class="hide"><a class="jp-stop"><i class="fa fa-stop"></i></a></div>

                    <div><img id="poster-ty" class="poster-img" src="images/a10.png"></div>
                    <div class="jp-progress hidden-xs">
                        <div class="jp-seek-bar dk">
                            <div class="jp-play-bar bg">

                            </div>
                            <div class="jp-title text-lt">
                                <ul>
                                    <li></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-xs hidden-sm jp-current-time text-xs text-muted"></div>
                    <div class="hidden-xs hidden-sm jp-duration text-xs text-muted"></div>
                    <div class="hidden-xs hidden-sm">
                        <a class="jp-mute" title="mute"><i class="icon-volume-2"></i></a>
                        <a class="jp-unmute hid" title="unmute"><i class="icon-volume-off"></i></a>
                    </div>
                    <div class="hidden-xs hidden-sm jp-volume">
                        <div class="jp-volume-bar dk volume-bor">
                            <div class="jp-volume-bar-value lter "></div>
                        </div>
                    </div>
                    <div>
                        <a class="jp-shuffle" title="shuffle"><i class="icon-shuffle text-muted"></i></a>
                        <a class="jp-shuffle-off hid" title="shuffle off"><i class="icon-shuffle text-lt"></i></a>
                    </div>
                    <div>
                        <a class="jp-repeat" title="repeat"><i class="icon-loop text-muted"></i></a>
                        <a class="jp-repeat-off hid" title="repeat off"><i class="icon-loop text-lt"></i></a>
                    </div>
                    <div>
                        <!--播放列表按钮-->
                        <a class="" data-toggle="dropdown" data-target="#playlist">
                            <i class="icon-playlist"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <!--播放列表-->
        <div class="jp-playlist dropup" id="playlist">
            <ul class="dropdown-menu aside-xl dker">
                <!-- The method Playlist.displayPlaylist() uses this unordered list -->
                <li class="list-group-item"></li>
            </ul>
        </div>
    </div>
</div>
</body>

<script>


    /*
    * { title: "you are my king", artist: "梶浦由記", mp3: "http://music.163.com/song/media/outer/url?id=22731459.mp3", poster: "http://p1.music.126.net/Xy8iaLLLVT21Mr9wDDJBNQ==/792747883650465.jpg?param=130y130" },

    *
    *
    *
    * */
    let latest=[];
     $(document).ready(function (latest) {
        let myPlaylist = new jPlayerPlaylist({
                jPlayer: "#jplayer_N",
                cssSelectorAncestor: "#jp_container_N"
            }, latest,
            {
                playlistOptions: {
                    enableRemoveControls: true,
                    autoPlay: false
                },
                swfPath: "js/jPlayer",
                supplied: "webmv, ogv, m4v, oga, mp3",
                useStateClassSkin: true,
                autoBlur: false,
                smoothPlayBar: true,
                keyEnabled: true,
                audioFullScreen: false
            }
        );
        myPlaylist.play(0);
        $(document).on($.jPlayer.event.pause, myPlaylist.cssSelector.jPlayer, function () {//$(document).on('click','要选择的元素',function(){})  on方法包含很多事件，点击，双击等等事件。
            $('.musicbar').removeClass('animate'); //look this class and remove it
            $('.jp-play-me').removeClass('active');
            $('.jp-play-me').parent('li').removeClass('active');
        });

        $(document).on($.jPlayer.event.play, myPlaylist.cssSelector.jPlayer, function () {
            $('.musicbar').addClass('animate');// when the player add a animate
        });
        $("#before,#after").addClass("set_imd");
        $(document).on('click', '.jp-play-me', function (e) {
            e && e.preventDefault();
            var $this = $(e.target);
            if (!$this.is('a')) $this = $this.closest('a');//closest() 方法获得匹配选择器的第一个祖先元素，从当前元素开始沿 DOM 树向上。
            $('.jp-play-me').not($this).removeClass('active');
            $('.jp-play-me').parent('li').not($this.parent('li')).removeClass('active');
            $this.toggleClass('active');
            $this.parent('li').toggleClass('active');
            if (!$this.hasClass('active')) {
                myPlaylist.pause();
            } else {
                //添加
                var k = $(this).parent("li").index();
                $(".poster-img").attr("src", latest[k].poster);//此方法返回一个函数改变src   $('a.cover1').html('<img src="' + latest[k].poster );
                $(".musicbar").addClass("animate").index();
                myPlaylist.add({
                    title: latest[k].title,
                    artist: latest[k].artist,
                    mp3: latest[k].mp3,
                    poster: latest[k].poster
                });
                myPlaylist.play(-1);
            }
        });
    });
    function getdata(pid){
        $.ajax({
            type:"post",
            url:"chapter/querypid",
            data:{pid:pid},
            dataType:"json",
            success:(data)=>{
                latest=data;
            }
        });

    }
</script>
</html>